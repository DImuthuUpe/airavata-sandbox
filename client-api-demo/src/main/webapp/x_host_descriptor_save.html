<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
</head>
<body>

<b> Register Host Description </b>
<br/>

Host Name           : <input type="text" name="hostName" id="hostName1" value="gram" size="75">
<br/>
Host Address        : <input type="text" name="hostAddress" id="hostAddress1" value="gatekeeper2.ranger.tacc.teragrid.org" size="75">
<br/>
Host Type           : <select name="drop1">
                         <option selected="true">Local</option>
                         <option>Globus</option>
                        </select>
<br/>
<div id="div">
Host Endpoint       : <input type="text" name="hostEndpoint" id="hostEndpoint1" value="gsiftp://gridftp.ranger.tacc.teragrid.org:2811/" size="75">
    <br/>
Gatekeeper Endpoint : <input type="text" name="gatekeeperEndpoint" id="gatekeeperEndpoint1" value="gatekeeper.ranger.tacc.teragrid.org:2119/jobmanager-sge" size="75">
    <br/>
</div>

<button name="btn2">Save Host</button>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script>
    function xmlToString(xml) {
        var xmlData = $(xml);
        var xmlString;
        if (window.ActiveXObject) {
            xmlString = xmlData.xml;
        } else {
            var oSerializer = new XMLSerializer();
            xmlString = oSerializer.serializeToString(xmlData[0]);
        }
        console.log(xmlString);
        return xmlString;
    }

    $(document).ready(function(){
        $(window).load(function () {
            $("div").hide();
        });

        $("select[name='drop1']").change(function() {
            //alert($(this).val());
            if("Local" == $(this).val()) {
                $("div").hide();
            } else {
                $("div").show();
            }
        });

        $('[name="btn2"]').click(function(){
            //alert($(this).val());
            alert("button btn2 clicked!");
            var hostName = $("#hostName1").val();
            var hostAddress = $("#hostAddress1").val();

//            var xml = $('<type:hostDescription xmlns:type="http://schemas.airavata.apache.org/gfac/type"><type:hostName>mylocalhost</type:hostName><type:hostAddress>127.0.01</type:hostAddress></type:hostDescription>');
            var xml = $('<type:hostDescription xmlns:type="http://schemas.airavata.apache.org/gfac/type"><type:hostName>' + hostName + '</type:hostName><type:hostAddress>' + hostAddress + '</type:hostAddress></type:hostDescription>');

            var xmlData= $(xml);
            var xmlString;
            if (window.ActiveXObject){
                xmlString = xmlData.xml;
            } else {
                var oSerializer = new XMLSerializer();
                xmlString = oSerializer.serializeToString(xmlData[0]);
            }
            console.log(xmlString);

            alert(hostName);
            alert(hostAddress);
            alert(xmlString);

            $.ajax({
                headers: {
                    Accept : "text/plain; charset=utf-8",
                    "Content-Type" : "text/xml"
//                    "Content-Type": "text/plain; charset=utf-8",
//                    "Accept-Encoding" : ""
                },
                type: "POST",
//                contentType : "application/x-www-form-urlencoded",
                url: "http://localhost:6060/airavata-registry-rest-services/registry/api/hostdescriptor/save",
                data: xmlString,
                dataType: "xml",
                cache: false,
                error: function() { alert("No data found."); },
                success: function(xml) {
                    alert("it works");
//                    alert($(xml).find("project")[0].attr("id"));
                }
            }).done(function( msg ) {
                        alert( "Data Saved: " + msg );
                    });

//            $.post("http://localhost:7080/airavata-registry-rest-services/registry/api/hostdescriptor/save",

            /*$.post("http://localhost:6060/airavata-registry-rest-services/registry/api/hostdescriptor/save",
                    { host: xmlString} ,function(data,status){
// TODO : REST api should send some response back in case of a successful invocation of service.
//                alert("Data: " + data + "\nStatus: " + status);
                        alert("button2 post sent !");
                    });*/
        });
    });
</script>

</body>
</html>

<!--"<type:hostDescription xsi:type="type:globusHostType" xmlns:type="http://schemas.airavata.apache.org/gfac/type" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">-->
    <!--<type:hostName>trestles</type:hostName>-->
    <!--<type:hostAddress>trestles.sdsc.edu</type:hostAddress>-->
    <!--<type:gridFTPEndPoint>gsiftp://trestles-dm1.sdsc.xsede.org:2811/</type:gridFTPEndPoint>-->
    <!--<type:globusGateKeeperEndPoint>trestles.sdsc.edu:2119/jobmanager-pbs</type:globusGateKeeperEndPoint>-->
<!--</type:hostDescription>"-->


<!--<type:hostDescription xmlns:type="http://schemas.airavata.apache.org/gfac/type">-->
    <!--<type:hostName>mylocalhost</type:hostName>-->
    <!--<type:hostAddress>127.0.01</type:hostAddress>-->
<!--</type:hostDescription>-->

<!--<type:hostDescription xmlns:type="http://schemas.airavata.apache.org/gfac/type">-->
    <!--<type:hostName>mylocalhost</type:hostName>-->
    <!--<type:hostAddress>127.0.01</type:hostAddress>-->
<!--</type:hostDescription>-->

<!--<type:hostdescription xmlns:type="http://schemas.airavata.apache.org/gfac/type">-->
    <!--<type:hostname>gram-99</type:hostname>-->
    <!--<type:hostaddress>gatekeeper2.ranger.tacc.teragrid.org</type:hostaddress>-->
<!--</type:hostdescription>-->


<!--curl -H "Accept: text/plain" -X POST -d 'host=<type:hostDescription xmlns:type="http://schemas.airavata.apache.org/gfac/type"><type:hostName>testHost3</type:hostName><type:hostAddress>aaaa</type:hostAddress></type:hostDescription>' http://localhost:7080/airavata-registry-rest-services/registry/api/hostdescriptor/save-->
<!--curl -H "Accept: text/plain" -X POST -d 'host=&lt;type:hostDescription xmlns:type=&quot;http://schemas.airavata.apache.org/gfac/type&quot;&gt;&lt;type:hostName&gt;mylocalhost2&lt;/type:hostName&gt;&lt;type:hostAddress&gt;127.0.01&lt;/type:hostAddress&gt;&lt;/type:hostDescription&gt;' http://localhost:7080/airavata-registry-rest-services/registry/api/hostdescriptor/save-->

<!--&lt;type:hostDescription xmlns:type=&quot;http://schemas.airavata.apache.org/gfac/type&quot;&gt;&lt;type:hostName&gt;mylocalhost2&lt;/type:hostName&gt;&lt;type:hostAddress&gt;127.0.01&lt;/type:hostAddress&gt;&lt;/type:hostDescription&gt;-->
